1. Check quality of reads by FastQc
	fastqc data_1.fastq
	fastqc data_2.fastq

2. Use Trim Galore to improve quality of reads
	trim_galore --fastqc --paired data_1.fastq data_2.fastq
		
3. Check quality of reads by FastQc after Trim Galore
	fastqc data_1.fastq
	fastqc fata_2.fastq
		
3. Prepare genom to alignment with BS-sequencing reads
	bismark_genome_preparation --path_to_bowtie /usr/bin/bowtie2/ --verbose /data/genomes/homo_sapiens/genom/
		
4. Alignment reads to genome
	bismark --path_to_bowtie /usr/bin/bowtie2/ --multicore 4 --genome /data/genomes/homo_sapiens/genom/ -1 data_1.fastq -2 data_2.fastq

5. Running deduplicate_bismark
	~/bismark/deduplicate_bismark --bam --paired  data.bam
	
6. Running bismark Methylation Extractor
	~/bismark/bismark_methylation_extractor --samtools_path /usr/bin/samtools/ --paired-end --no_overlap --zero_based --ignore_r2 2 --remove_spaces 
	--bedGraph --cytosine_report --buffer_size 10G --gzip --genome_folder /data/genomes/homo_sapiens/genom/ data.bam

8. Running CpGIslandFinder.py to get GTF file with CpGislands
	python3 ~/Python_script/CpGIslandFinder.py  /data/genomes/homo_sapiens/genom/hg19.fa


9. Change CpGislands.GTF file to CpGislands.bed file 
	awk '{ print $2"\t"$4"\t"$5"\tCpGisland\t.\t"$7"\n"}' CpGislands.gtf > CpGislands.bed
	
10. Add percentage of methylation:
	bedtools2/bin/intersectBed -a CpGisland.bed -b SRR6806743.deduplicated.bedGraph -wa -wb | 
	bedtools2/bin/groupBy -i - -g 1-3 -c 10,10 -o count,mean > CpGisland_met.bed

11. Add annotation: 
	bedtools2/bin/intersectBed -a CpGisland_met.bed -b hg19.bed -wa -wb | 
	awk -v OFS="\t" '{print $1,$2,$3,$5,$9,$11}' > CpGisland_annotation.gtf



	




